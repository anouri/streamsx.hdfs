namespace com.ibm.streamsx.hdfs.bluemix.sample;

use com.ibm.streamsx.webhdfs::*;

composite TestDirScan {

    graph

        stream<rstring filename> Files = WebHdfsDirectoryScan() {
            param 
                url:getSubmissionTimeValue("url");
directory: getSubmissionTimeValue("linefile","/tmp/");
password: getSubmissionTimeValue("password");
username: getSubmissionTimeValue("username");
        }

    () as sink = FileSink(Files) {
        param file: "files.txt";
    }

}
